= Release Notes Generation Tool (RLGEN)
:author: Pantelis Tzamalis
:email: tzamalis@ceid.upatras.gr

== Release Note: 5.backlog.GA

* Total Jiras: 6

==== JWS-1374

* Summary: tomcat doesn't clean own logs by logrotate

* Description:

============================

+++ This bug was initially created as a clone of Bug #1701249 +++
Description of problem:
I look at system where the tomcat has run for long time. And a lot of old log files exist, I suppose that the logs should be cleaned.

{code:bash}
$ ls  /var/log/tomcat/
total 931192    <<<<<<<<<<<<<see the high amount of files (!)
-rw-r--r-- 1 tomcat tomcat     18938 Sep 28  2016 catalina.2016-09-28.log
-rw-r--r-- 1 tomcat tomcat     28648 Sep 29  2016 catalina.2016-09-29.log
-rw-r--r-- 1 tomcat tomcat      9461 Sep 30  2016 catalina.2016-09-30.log
-rw-r--r-- 1 tomcat tomcat      9675 Oct  1  2016 catalina.2016-10-01.log
-rw-r--r-- 1 tomcat tomcat      9925 Oct  3  2016 catalina.2016-10-03.log
-rw-r--r-- 1 tomcat tomcat      9478 Oct  4  2016 catalina.2016-10-04.log
-rw-r--r-- 1 tomcat tomcat     67972 Oct  5  2016 catalina.2016-10-05.log
-rw-r--r-- 1 tomcat tomcat      9670 Oct  6  2016 catalina.2016-10-06.log
-rw-r--r-- 1 tomcat tomcat      9674 Oct  7  2016 catalina.2016-10-07.log
-rw-r--r-- 1 tomcat tomcat      9674 Oct  8  2016 catalina.2016-10-08.log
-rw-r--r-- 1 tomcat tomcat      9674 Oct  9  2016 catalina.2016-10-09.log
-rw-r--r-- 1 tomcat tomcat      9727 Oct 10  2016 catalina.2016-10-10.log
-rw-r--r-- 1 tomcat tomcat      9477 Oct 11  2016 catalina.2016-10-11.log
-rw-r--r-- 1 tomcat tomcat      9674 Oct 12  2016 catalina.2016-10-12.log
-rw-r--r-- 1 tomcat tomcat      9675 Oct 13  2016 catalina.2016-10-13.log
-rw-r--r-- 1 tomcat tomcat       250 Oct 17  2016 catalina.2016-10-17.log
-rw-r--r-- 1 tomcat tomcat       250 Oct 24  2016 catalina.2016-10-24.log
-rw-r--r-- 1 tomcat tomcat       250 Oct 31  2016 catalina.2016-10-31.log
-rw-r--r-- 1 tomcat tomcat     59532 Nov  1  2016 catalina.2016-11-01.log
-rw-r--r-- 1 tomcat tomcat     28430 Nov  4  2016 catalina.2016-11-04.log
-rw-r--r-- 1 tomcat tomcat       250 Nov  7  2016 catalina.2016-11-07.log
-rw-r--r-- 1 tomcat tomcat       250 Nov 14  2016 catalina.2016-11-14.log
-rw-r--r-- 1 tomcat tomcat    237373 Nov 17  2016 catalina.2016-11-17.log
-rw-r--r-- 1 tomcat tomcat       250 Nov 21  2016 catalina.2016-11-21.log
-rw-r--r-- 1 tomcat tomcat       250 Nov 28  2016 catalina.2016-11-28.log
-rw-r--r-- 1 tomcat tomcat     34337 Nov 29  2016 catalina.2016-11-29.log
-rw-r--r-- 1 tomcat tomcat     34003 Nov 30  2016 catalina.2016-11-30.log
-rw-r--r-- 1 tomcat tomcat     61087 Dec  1  2016 catalina.2016-12-01.log
-rw-r--r-- 1 tomcat tomcat     68240 Dec  2  2016 catalina.2016-12-02.log
-rw-r--r-- 1 tomcat tomcat     34581 Dec  3  2016 catalina.2016-12-03.log
-rw-r--r-- 1 tomcat tomcat     30584 Dec  4  2016 catalina.2016-12-04.log
-rw-r--r-- 1 tomcat tomcat     32703 Dec  5  2016 catalina.2016-12-05.log
-rw-r--r-- 1 tomcat tomcat     35446 Dec  6  2016 catalina.2016-12-06.log
-rw-r--r-- 1 tomcat tomcat     35461 Dec  7  2016 catalina.2016-12-07.log
-rw-r--r-- 1 tomcat tomcat     35162 Dec  8  2016 catalina.2016-12-08.log
-rw-r--r-- 1 tomcat tomcat     79718 Dec  9  2016 catalina.2016-12-09.log
-rw-r--r-- 1 tomcat tomcat     35161 Dec 10  2016 catalina.2016-12-10.log
-rw-r--r-- 1 tomcat tomcat     31463 Dec 11  2016 catalina.2016-12-11.log
-rw-r--r-- 1 tomcat tomcat     33837 Dec 12  2016 catalina.2016-12-12.log
-rw-r--r-- 1 tomcat tomcat     34005 Dec 13  2016 catalina.2016-12-13.log
.
snip
.
-rw-r--r-- 1 tomcat tomcat         0 Mar  1 20:10 manager.2019-03-01.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  2 20:11 manager.2019-03-02.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  3 20:11 manager.2019-03-03.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  4 20:10 manager.2019-03-04.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  5 20:11 manager.2019-03-05.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  6 07:32 manager.2019-03-06.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  7 20:09 manager.2019-03-07.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  8 20:11 manager.2019-03-08.log
-rw-r--r-- 1 tomcat tomcat         0 Mar  9 20:09 manager.2019-03-09.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 10 20:10 manager.2019-03-10.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 11 20:11 manager.2019-03-11.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 12 20:10 manager.2019-03-12.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 13 20:10 manager.2019-03-13.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 14 13:46 manager.2019-03-14.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 15 20:10 manager.2019-03-15.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 16 20:10 manager.2019-03-16.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 17 20:11 manager.2019-03-17.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 18 20:12 manager.2019-03-18.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 19 20:12 manager.2019-03-19.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 20 20:11 manager.2019-03-20.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 21 20:10 manager.2019-03-21.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 22 20:11 manager.2019-03-22.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 23 20:09 manager.2019-03-23.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 24 20:11 manager.2019-03-24.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 25 20:11 manager.2019-03-25.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 26 20:12 manager.2019-03-26.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 27 20:12 manager.2019-03-27.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 28 10:19 manager.2019-03-28.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 29 20:11 manager.2019-03-29.log
-rw-r--r-- 1 tomcat tomcat         0 Mar 31 20:12 manager.2019-03-31.log
-rw-r--r-- 1 tomcat tomcat         0 Apr  1 07:11 manager.2019-04-01.log
-rw-r--r-- 1 tomcat tomcat         0 Apr  2 09:30 manager.2019-04-02.log
-rw-r--r-- 1 tomcat tomcat         0 Apr  3 14:26 manager.2019-04-03.log
-rw-r--r-- 1 tomcat tomcat         0 Apr  4 07:30 manager.2019-04-04.log
{code}

{code:bash}
$ cat etc/logrotate.d/tomcat 
/var/log/tomcat/catalina.out {
    copytruncate
    weekly
    rotate 52
    compress
    missingok
    create 0644 tomcat tomcat
}
{code}

Version-Release number of selected component (if applicable):

{code:bash}
$ cat etc/redhat-release 
Red Hat Enterprise Linux Server release 7.6 (Maipo)
$ grep -i tomcat installed-rpms 
lh555.server.raiffeisen.ch-tomcat-1.0-1.noarch              Tue Feb 13 07:04:46 2018
tomcat-7.0.76-8.el7_5.noarch                                Wed Nov 14 09:19:38 2018
tomcat-el-2.2-api-7.0.76-8.el7_5.noarch                     Wed Nov 14 09:18:39 2018
tomcat-jsp-2.2-api-7.0.76-8.el7_5.noarch                    Wed Nov 14 09:18:05 2018
tomcat-lib-7.0.76-8.el7_5.noarch                            Wed Nov 14 09:18:40 2018
tomcat-servlet-3.0-api-7.0.76-8.el7_5.noarch                Wed Nov 14 09:18:04 2018
{code}

How reproducible:
alawys

Steps to Reproduce:
1. run tomcat long time
2. show content of directory with logs 

Actual results:
A lot of logs files

Expected results:
old log files was compressed or remove

Additional info:

The same bug was opened for rhel 6.9 but was closed as WONTFIX due to "Red Hat Enterprise Linux 6 is in the Production 3 Phase."

============================

==== JWS-1320

* Summary: ASF BZ 63199: Tomcat Native: sslsocket handshake JVM crash

* Description:

============================

See https://bz.apache.org/bugzilla/show_bug.cgi?id=63199

TODO:

 * reproduce
 * debug

============================

==== JWS-1274

* Summary: Review and Revise the JWS Documentation Set

* Description:

============================

Full review of JWS documentation set.
- Test for technical accuracy
- Modularise
- Bring docs up to current internal standards and prepare for future docs build/deployment changes:
-- [CCS: FY19 Goals and Initiatives|https://mojo.redhat.com/docs/DOC-1166815]
-- [Modular Documentation Project|https://mojo.redhat.com/docs/DOC-1103812]


============================

==== JWS-1272

* Summary: Create the JWS Security Hardening Guide

* Description:

============================

Create a Security hardening Guide based on customer requirement

============================

==== JWS-855

* Summary: Poor UX of Native libraries installation for Tomcat Embedded users

* Description:

============================

In order to use APR connector or NIO+JSSE+OpenSSL connector in an embedded application, one has to:
 * download standalone Tomcat distribution zip
 * extract lib directory from that zip
 * set LD_LIBRARY_PATH
 * run one's embedded web application

e.g. 
{code}
unzip jws-application-server-4.0.0-CR1-RHEL7-x86_64.zip jws-4.0/tomcat/lib* -d /tmp/tomcat-libs
export LD_LIBRARY_PATH=/tmp/tomcat-libs/jws-4.0/tomcat/lib/
java -jar target/embedded-tomcat-app.jar
{code}

It is exceedingly cumbersome. Could we device a better way? Is it feasible to package .so files inside some jar and put that jar in the Maven repository and let the web app to depend on it? For example, see [wildfly-openssl-1.0.3.Final-SNAPSHOT.jar|https://ci.modcluster.io/job/wildfly-openssl-windows/arch=64,label=w2k12r2/lastSuccessfulBuild/artifact/combined/target/wildfly-openssl-1.0.3.Final-SNAPSHOT.jar] and its:
{code}
    win-x86_64/
    win-x86_64/wfssl.dll
    win-x86_64/wfssl.exp
    win-x86_64/wfssl.lib
{code}


h3. Simplified example
While the size of the Wildfly-OpenSSL project is quite intimidating, one can take a look at a dead-simple Linux+Windows demo hobby project streamlining the procedure to the bare minimum: https://github.com/Karm/CRC64Java

============================

==== JWS-683

* Summary: Add documentation in docs-zip for mod_cluster

* Description:

============================

The docs zip distribution provided by JWS (e.g. jws-docs-3.1.0.zip) includes an empty mod_cluster directory. That directory should be populated with the upstream documentation for users.

============================

== Release Note: httpd 2.4.backlog.GA

* Total Jiras: 5

==== JBCS-783

* Summary: Prepare smoke testing for mod_brotli on RHEL and Windows

* Description:

============================

 * mod_brotli as a part of upstream 2.4.37 enters our product
 * we need to check it works, simple smoke tests suffices as it is battle tested at Google and community 

============================

==== JBCS-782

* Summary: add mod_brotli to rhel6/7 and windows

* Description:

============================

None

============================

==== JBCS-749

* Summary: Apache plugin doesn't discover Virtual Hosts on Windows

* Description:

============================

The Apache plugin will not discover Apache Virtual Hosts on Windows, it appears the plugin uses Augeas for the discovery and it's not totally supported on Windows.  Can something else be used to discover Virtual Hosts configured in separate files.

============================

==== JBCS-747

* Summary: JWS3.0-Document that httpd module mod_proxy_hcheck is not provided on windows

* Description:

============================

Document that httpd module mod_proxy_hcheck is not provided on windows

https://access.redhat.com/solutions/2823881

============================

==== JBCS-451

* Summary: mod_proxy_http incorrectly requires continue response after already sending response data

* Description:

============================

mod_proxy_http always requires a continue response from the back end for a proxied POST.  This is incorrect when it has already sent response data.  The [RFC7231|https://tools.ietf.org/pdf/rfc7231.pdf#nameddest=78] related to HTTP1.1 section 5.1.1 states:
{code}
A server MAY omit sending a 100 (Continue) response if it has
      already received some or all of the message body for the
      corresponding request, or if the framing indicates that there is
      no message body
{code}

So then mod_proxy_http sends the Expect header along with the request body and then waits for the 100-continue, which could be an issue if the backend chooses to omit it per the spec above.  That can lead to POST requests hitting the ping timeout undesirably.

This was never a concern with EAP 6/JBossWeb since it always sent the 100-continue regardless.  But currently, EAP 7/Undertow chooses to omit it in this scenario, which causes request failures and error states from ping timeouts.  This also impacts mod_cluster if proxying over http.

If mod_proxy_http is always going to require a 100-continue response, then we have to ensure it doesn't send the request body before that response.  Or it may be helpful to provide some other means of disabling this POST 100-continue ping besides force-proxy-request-1.0.

============================



----------
Report time: 2019-08-07 11:28:31.944696


